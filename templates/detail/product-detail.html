{% extends "base.html" %}
{% load static %}

{% block title %}
  Products
{% endblock %}

{% block extrastyles %}

{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-center">Webshop's Pet Products</h1>

  <main class="table">
	<!-- Product Details -->
	<h3 class="my-4 border-bottom pb-1">
    {% for product in data %}
          <h3 class="card-title">{{ product.name }}</h3>
          <tr><img src="{{ product.image.url }}" class="image-responsive"></tr><br>
          <tr>{{ product.description }}</tr>
          <tr><p class="card-text">Item: {{ product.code }}</p></tr>
          <tr>${{ product.price }}</tr>
          <div class="input-group my-3" style="width:30%;">
            <tr><button data-product_id={{product.id}} data-product_name={{product.name}} data-price={{product.price}} data-qty="1" onclick="addToCart(this)" type="button" class="btn btn-primary btn-sm addToCartBtn"><i class="fa fa-shopping-cart"></i> Add to Cart</button></tr>
          </div>
      </table>
    </div>
  {% endfor %}
</div>
</div>
</main>


<!-- Add To Cart  -->
<script>

  function addToCart(button) {
    const product_id = button.dataset.product_id
    const product_name = button.dataset.product_name
    const price = button.dataset.price
    const qty = button.dataset.qty 

    console.log(product_id, product_name, price, qty)


      $.ajax({
        url: "/add_to_cart/",
        data: {
          "product_id": product_id,
          "product_name": product_name,
          "qty": qty,
          "price": price,
        },
        dataType: 'json',

        success:function(res){
                $(".cart-list").text(res.totalitems);
        },

        error:function(){
          console.log('fail')
        }

      });
    };
</script>

{% endblock %}
