{% extends "base.html" %}
{% load static %}

{% block title %}
  Products
{% endblock %}

{% block extrastyles %}

{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-center">Webshop's Pet Products</h1>
  <h3 class="text-center">{{ product.name }}</h3>

  <main class="table">
	<!-- Product Details -->
	<h3 class="my-4 border-bottom pb-1">
    {% for product in data %}
          <h3>{{ product.name }}</h3>
          <img src="{{ product.image.url }}" class="image-responsive">
          <p class="card-body">{{ product.description }}</p>
			    <h6 class="card-text">Item: {{ product.code }}</h6>
          <p class="price">${{ product.price }}</p>

          <div class="input-group my-3" style="width:30%;">
            <input type="number" class="form-control" id="qty" value="">
            <div class="input-group-append"></div>
              <input type="hidden" class="id" value="{{ product.id }}">
              <input type="hidden" class="price" value="{{ product.price }}">
                <button class="btn btn-primary btn-sm" type="button" id="addToCartBtn"><i class="fa fa-shopping-cart"></i> Add to Cart</button>
          </div>
    {% endfor %}
</main>



<!-- Add To Cart -->
<script>
$(document).ready(function () {
  $(document).on('click', "#addToCartBtn",function(e){
      e.preventDefault();
      var qty=$('#qty').val();
      var id=$('.id').val();
      var price=$('.price').val();
      console.log(qty, id, price)


      $.ajax({
        url: "/add_to_cart/",
        data: {
          "id": id,
          "qty": qty,
          "price": price,
        },
        dataType: 'json',

        success:function(res){
                $(".cart-list").text(res.totalitems);
        },

        error:function(){
          console.log('fail')
        }

      });
});
}) 
  </script>

{% endblock %}
