{% extends "base.html" %}
{% load static %}

{% block title %}
  Products
{% endblock %}

{% block extrastyles %}

{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-center">Webshop's Pet Products</h1>
</div>

<main class="container my-4">
	<h3 class="my-4 border-bottom pb-1"></h3>
	<div class="row">
      {% for product in products %}
      <div class="col-md-4 mb-4 tables">
        <table class="table mt-3 sortable"></table>
              <tr><img src="{{ product.image.url }}" class="image-responsive"></tr>
              <tr><a href="{% url 'product_detail' product.id %}"><h5 class="card-title">{{ product.name }}</h5></a></tr>
              <tr><p class="card-text">Item: {{ product.code }}</p></tr>
              <tr>${{ product.price }}</tr>
              <div class="input-group my-3" style="width:30%;">
                <tr><button data-product_id={{product.id}} data-qty="1" onclick="addToCart(this)" type="button" class="btn btn-primary btn-sm addToCartBtn"><i class="fa fa-shopping-cart"></i> Add to Cart</button></tr>
              </div>
          </table>
        </div>
      {% endfor %}
    </div>
  </div>
</main>



<!-- Add To Cart  -->

<script>

function addToCart(button) {
        const product_id = button.dataset.product_id
        const qty = button.dataset.qty
  
  
          $.ajax({
            url: "/add_to_cart/",
            data: {
              "product_id": product_id,
              "qty": qty,
            },
            dataType: 'json',
    
            success:function(res){
                    $(".cart-list").text(res.totalitems);
            },
    
            error:function(){
              console.log('fail')
            }
    
          });
        };


</script>





{% endblock %}
